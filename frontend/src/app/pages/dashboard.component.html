<!-- Stat Cards -->
<div class="stat-grid">
  <div class="stat-card">
    <div class="stat-icon green">ğŸ–¥</div>
    <div class="stat-body">
      <div class="stat-label">ç³»çµ±ç‹€æ…‹</div>
      <div class="stat-value"
        [class.text-success]="health?.status === 'ok'"
        [class.text-danger]="health && health.status !== 'ok'"
        [class.text-muted]="!health">
        {{ health?.status === 'ok' ? 'æ­£å¸¸é‹è¡Œ' : (health ? 'ç•°å¸¸' : 'â€¦') }}
      </div>
    </div>
  </div>

  <div class="stat-card">
    <div class="stat-icon cyan">ğŸ”Œ</div>
    <div class="stat-body">
      <div class="stat-label">Unitrade é€£ç·š</div>
      <div class="stat-value"
        [class.text-success]="health?.unitrade === 'connected'"
        [class.text-danger]="health && health.unitrade !== 'connected'"
        [class.text-muted]="!health">
        {{ health?.unitrade ?? 'â€¦' }}
      </div>
    </div>
  </div>

  <div class="stat-card">
    <div class="stat-icon purple">âš™</div>
    <div class="stat-body">
      <div class="stat-label">å•Ÿç”¨ç­–ç•¥</div>
      <div class="stat-value">{{ strategyCount ?? 'â€¦' }}</div>
    </div>
  </div>

  <div class="stat-card">
    <div class="stat-icon orange">ğŸ“¡</div>
    <div class="stat-body">
      <div class="stat-label">ä»Šæ—¥è¨Šè™Ÿ</div>
      <div class="stat-value">{{ todaySignals ?? 'â€¦' }}</div>
    </div>
  </div>
</div>

<!-- Info Grid -->
<div class="grid grid-3" style="margin-bottom: 20px">

  <div class="card">
    <div class="card-header">
      <div class="card-title">é€£ç·šç‹€æ…‹</div>
    </div>
    <ng-container *ngIf="health; else loadingTpl">
      <div class="info-row">
        <span class="info-label">API ä¼ºæœå™¨</span>
        <span class="badge" [ngClass]="health.status === 'ok' ? 'success' : 'error'">
          {{ health.status === 'ok' ? 'ONLINE' : 'ERROR' }}
        </span>
      </div>
      <div class="info-row">
        <span class="info-label">Unitrade</span>
        <span class="badge" [ngClass]="health.unitrade === 'connected' ? 'success' : 'error'">
          {{ health.unitrade }}
        </span>
      </div>
    </ng-container>
    <ng-template #loadingTpl>
      <div class="loading-row">é€£ç·šä¸­â€¦</div>
    </ng-template>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-title">API ç«¯é»</div>
    </div>
    <div class="endpoint-row">
      <span class="method-badge post">POST</span>
      <code class="endpoint-path">/webhook</code>
      <span class="endpoint-desc">è¨Šè™Ÿæ¥æ”¶</span>
    </div>
    <div class="endpoint-row">
      <span class="method-badge post">POST</span>
      <code class="endpoint-path">/order</code>
      <span class="endpoint-desc">æ‰‹å‹•ä¸‹å–®</span>
    </div>
    <div class="endpoint-row">
      <span class="method-badge get">GET</span>
      <code class="endpoint-path">/health</code>
      <span class="endpoint-desc">å¥åº·æª¢æŸ¥</span>
    </div>
    <div class="endpoint-row">
      <span class="method-badge get">GET</span>
      <code class="endpoint-path">/signals</code>
      <span class="endpoint-desc">è¨Šè™Ÿè¨˜éŒ„</span>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-title">å¿«é€Ÿå°è¦½</div>
    </div>
    <div class="quick-links">
      <a class="quick-link" routerLink="/strategies">âš™ ç­–ç•¥ç®¡ç†</a>
      <a class="quick-link" routerLink="/orders">â‡… æ‰‹å‹•ä¸‹å–®</a>
      <a class="quick-link" routerLink="/positions">â—‰ æŒå€‰éƒ¨ä½</a>
      <a class="quick-link" routerLink="/alerts">â— è¨Šè™Ÿè¨˜éŒ„</a>
    </div>
  </div>

</div>

<!-- Recent Signals Table -->
<div class="card">
  <div class="card-header">
    <div class="card-title">æœ€è¿‘è¨Šè™Ÿè¨˜éŒ„</div>
    <a routerLink="/alerts" style="font-size: 12px; color: var(--primary)">æŸ¥çœ‹å…¨éƒ¨ â†’</a>
  </div>
  <ng-container *ngIf="recentSignals.length > 0; else noSignals">
    <table>
      <thead>
        <tr>
          <th>æ™‚é–“</th>
          <th>ç­–ç•¥</th>
          <th>è¨Šè™Ÿ</th>
          <th>å•†å“</th>
          <th>ç‹€æ…‹</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let s of recentSignals">
          <td class="text-muted" style="font-size: 12px; font-family: monospace; white-space: nowrap">
            {{ s.created_at | date:'MM/dd HH:mm:ss' }}
          </td>
          <td>{{ s.strategy_name }}</td>
          <td>
            <span class="badge" [ngClass]="getSignalClass(s.signal_type)">{{ s.signal_type }}</span>
          </td>
          <td>{{ s.actual_product || s.signal_product || 'â€”' }}</td>
          <td>
            <span class="badge" [ngClass]="s.status === 'success' ? 'success' : (s.status === 'error' ? 'error' : 'info')">
              {{ s.status }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </ng-container>
  <ng-template #noSignals>
    <div class="empty-state">å°šç„¡è¨Šè™Ÿè¨˜éŒ„</div>
  </ng-template>
</div>
